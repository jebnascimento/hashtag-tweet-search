<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Hashtag Search Tweets</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet"
        type="text/css">
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"
        type="text/css">
</head>

<body>
    <div class="container">
        <div class="form mb-2 mt-2"> 
        <fieldset>
            <form action="/" method="post">
                <div class="input-group">
                <input class="form-control" name="hashtag" placeholder="ex. #covid-19" required type="text">
                <input type="submit" value="Analyze!">
                </div>
            </form>
        </fieldset>
    </div>   
    

    <div class="container-fluid">

    </div>
    <% if(hashtag !== null){ %>
        <div align="center">
            <h3>Principais Tweets para <%- hashtag %></h3>
        </div>

    <% } %>

<div id="tweets"></div>

    <% if(tweets !== null){ %>

       
    <script>
        let tweets = <%- JSON.stringify(tweets) %>;
        let tweetHTML = '<div class="row">';
        for (let index = 0; index < tweets.statuses.length; index++) {
            var createdDateTime = new Date(tweets.statuses[index].created_at);

             if(tweets.statuses[index].retweeted_status !== undefined){
                console.log('entrou aquiaaaaaaaaaaaaaaaaaaaa')
                tweetHTML += '<div class="col-sm-4"><div class="card mb-3">' +
                '<div class="card-body">' +
                '<h5 class="card-title">@' + tweets.statuses[index].user.screen_name + '</h5>' +
                '<h6 class="card-subtitle mb-2 text-muted">' + tweets.statuses[index].user.name + '</h6>' +
                '<p class="card-text">' + tweets.statuses[index].retweeted_status.full_text + '<</p>' +
                '<p class="card-text"><i class="fa fa-retweet" aria-hidden="true"></i> ' + tweets.statuses[index].retweet_count + ' <i class="fa fa-heart" style="color:red;" aria-hidden="true"></i> ' + tweets.statuses[index].favorite_count + '</p>' +
                
              //  '<a class="card-link" href="#">Another link</a>' +
                '<p class="card-text"><small class="text-muted">'+createdDateTime.toString()+' </small></p>' +
                '</div>' +
                '</div>' +
                '</div>';

             } 
             else{
                tweetHTML += '<div class="col-sm-4"><div class="card mb-3">' +
                '<div class="card-body">' +
                '<h5 class="card-title">@' + tweets.statuses[index].user.screen_name + '</h5>' +
                '<h6 class="card-subtitle mb-2 text-muted">' + tweets.statuses[index].user.name + '</h6>' +
                '<p class="card-text">' + tweets.statuses[index].full_text + '<</p>' +
                '<p class="card-text"><i class="fa fa-retweet" aria-hidden="true"></i> ' + tweets.statuses[index].retweet_count + ' <i class="fa fa-heart" style="color:red;" aria-hidden="true"></i> ' + tweets.statuses[index].favorite_count + '</p>' +
                
              //  '<a class="card-link" href="#">Another link</a>' +
                '<p class="card-text"><small class="text-muted">'+createdDateTime.toString()+' </small></p>' +
                '</div>' +
                '</div>' +
                '</div>';

             }
            
        }
        tweetHTML += '</div>';

        var tweetsContainer = document.getElementById('tweets');
        tweetsContainer.insertAdjacentHTML('beforeend', tweetHTML);
    </script>

    <% } %>
</body>

</html>